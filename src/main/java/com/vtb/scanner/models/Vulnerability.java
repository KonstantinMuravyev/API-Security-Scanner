package com.vtb.scanner.models;

import lombok.Data;
import lombok.Builder;

/**
 * Представление уязвимости в API
 */
@Data
@Builder
public class Vulnerability {
    private String id;
    private VulnerabilityType type;
    private Severity severity;
    private String title;
    private String description;
    private String endpoint;
    private String method;
    private String evidence;
    private String recommendation;
    private String owaspCategory; // Например: "API1:2023 - BOLA"
    
    @Builder.Default
    private boolean gostRelated = false; // Связана ли с ГОСТ стандартами
    
    // Профессиональная информация
    private String cwe; // CWE-639
    private java.util.List<String> cveExamples; // CVE-2019-9515
    private String owaspRating; // Common | Easy | Severe
    
    // Confidence & Risk Scoring (НОВОЕ!)
    @Builder.Default
    private int confidence = 75; // Уверенность 0-100%
    
    @Builder.Default
    private int riskScore = 0; // Числовая оценка риска 0-250
    
    @Builder.Default
    private int priority = 3; // Приоритет исправления 1-5
    
    private String impactLevel; // Влияние на бизнес
}

